schedules:
- cron: 0 0 * * *
  displayName: Nightly NuGet Rollup
  branches:
    include:
    - main

# Not including the none trigger results in the default of "include *"
trigger: none

resources:
  pipelines:
  - pipeline: nsci
    source: number-sequence
    branch: main
    tags:
    - IndividualCI

name: '$(Date:%y).$(DayOfYear).$(Rev:r)'

pool:
  vmImage: windows-latest

steps:

- checkout: none

- powershell: |
    Write-Host "##vso[Build.UpdateBuildNumber]$(resources.pipeline.nsci.runName) ($(Build.BuildNumber))"
  displayName: Update build number from source build

- download: nsci
  artifact: drop
  displayName: Download build drop

- task: NuGetCommand@2
  displayName: NuGet push
  inputs:
    command: push
    packagesToPush: $(Agent.BuildDirectory)\nsci\drop\TcpWtf.*.nupkg
    nuGetFeedType: external
    publishFeedCredentials: 6e102607-a20d-4516-b9f5-aec98404ab4c
